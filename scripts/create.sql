CREATE TABLE PESSOA (
	CPF 			VARCHAR(11)		NOT NULL,
	NOME 			VARCHAR(200)	NOT NULL,
	SOBRENOME 		VARCHAR(200)	NOT NULL,
	EMAIL			VARCHAR(200)	NOT NULL UNIQUE,
	DATA_NASC		DATE			NOT NULL,
	SEXO			VARCHAR(15)		NOT NULL,
	ID_ENDERECO 	INT				NOT NULL,
	TELEFONE		VARCHAR(15)		NOT NULL,
	ROLE			VARCHAR(20)		NOT NULL,
	SITUACAO 		VARCHAR(200) 	NOT NULL,
	SENHA			VARCHAR(200)	NOT NULL,
	PRIMARY KEY(CPF),
	FOREIGN KEY(ID_ENDERECO) REFERENCES ENDERECO(ID)
)

CREATE TABLE PRODUTO (
	COD					VARCHAR(20) 	NOT NULL,
	NOME 				VARCHAR(200)	NOT NULL,
	DESCRICAO			VARCHAR(200),
	TIPO_PRODUTO		VARCHAR(20)		NOT NULL,
	IMAGE_URL			VARCHAR(500)	NOT NULL
	PRIMARY KEY(COD)
)

CREATE TABLE FEIRA (
	CONTEXTO			VARCHAR(20)		PRIMARY KEY,
	ID_ENDERECO			INT 			NOT NULL,
	NOME 				VARCHAR(200)	NOT NULL,
	TELEFONE_CONTATO	VARCHAR(15),
	LATITUDE			VARCHAR(50)		NOT NULL,
	LONGITUDE			VARCHAR(50)		NOT NULL,
	DIA_ENTREGA			INT				NOT NULL,
	PRIMARY KEY(ID),
	FOREIGN KEY(ID_ENDERECO) REFERENCES ENDERECO(ID)
)

-- 1 - DOMINGO, 2 - SEGUNDA, 3 - TERÃ‡A, 4 - QUARTA, 5 - QUINTA, 6 - SEXTA, 7 - SABADO

CREATE TABLE ENDERECO (
	ID 					INT 		 	NOT NULL AUTO_INCREMENT,
	NUMERO 				VARCHAR(20)		NOT NULL,
	CEP					VARCHAR(20)		NOT NULL,
	COMPLEMENTO			VARCHAR(200)	NOT NULL,
	BAIRRO				VARCHAR(200)	NOT NULL,
	CIDADE				VARCHAR(200)	NOT NULL,
	UF					VARCHAR(2)		NOT NULL,
	LOGRADOURO 			VARCHAR(200)	NOT NULL,
	PRIMARY KEY(ID)
)

CREATE TABLE PRODUTO_FEIRA (
	COD_PRODUTO 	VARCHAR(20)  	NOT NULL,
	CONTEXTO		VARCHAR(20)		NOT NULL,
	PRECO			DECIMAL(7,2) 	NOT NULL,
	ATIVO			BOOLEAN 		NOT NULL,
	UNIDADE_MEDIDA 	VARCHAR(50) 	NOT NULL,
	PRIMARY KEY(COD_PRODUTO, CONTEXTO),
	FOREIGN KEY(COD_PRODUTO) REFERENCES PRODUTO(COD),
	FOREIGN KEY(CONTEXTO) REFERENCES FEIRA(CONTEXTO)
)

CREATE TABLE CUPOM(
	NOME VARCHAR(200) NOT NULL,
	PORCENTAGEM DECIMAL(7,2) NOT NULL,
	ATIVO BOOLEAN NOT NULL,
	PRIMARY KEY(NOME)
)

CREATE TABLE PEDIDO (
	NUMERO			BIGINT			NOT NULL AUTO_INCREMENT,
	DATA_PEDIDO		DATE 			NOT NULL,
	STATUS_PEDIDO	VARCHAR(50)		NOT NULL,
	DATA_ENTREGA	DATE			NOT NULL,
	CUPOM			VARCHAR(200)	NOT NULL,
	CPF_PESSOA		VARCHAR(11)		NOT NULL,
	COBRANCA		VARCHAR(20)		NOT NULL,
	VALOR_TOTAL		DECIMAL(7,2)	NOT NULL,
	PRIMARY KEY(NUMERO),
	FOREIGN KEY (CPF_PESSOA)	REFERENCES PESSOA(CPF)
)

CREATE TABLE PAGAMENTO (
	ID					BIGINT			NOT NULL AUTO_INCREMENT,
	NUMERO_PEDIDO		BIGINT			NOT NULL,
	NUMERO_CARTAO		VARCHAR(50)		NOT NULL,
	VALIDADE_CARTAO		VARCHAR(50)		NOT NULL,
	CVV					VARCHAR(50)		NOT NULL,
	DATA				DATE			NOT NULL,
	PRIMARY KEY(ID),
	FOREIGN KEY (NUMERO_PEDIDO) REFERENCES PEDIDO(NUMERO)
)

CREATE TABLE CARRINHO (
	NUMERO_PEDIDO	BIGINT			NOT NULL,
	COD_PRODUTO 	VARCHAR(20)  	NOT NULL,
	CONTEXTO		VARCHAR(20)		NOT NULL,
	QUANTIDADE		INT				NOT NULL,
	PRIMARY KEY CARRINHO (COD_PRODUTO, CONTEXTO, NUMERO_PEDIDO),
	FOREIGN KEY(COD_PRODUTO) REFERENCES PRODUTO(COD),
	FOREIGN KEY(CONTEXTO) REFERENCES FEIRA(CONTEXTO),
	FOREIGN KEY(NUMERO_PEDIDO) REFERENCES PEDIDO(NUMERO)
)